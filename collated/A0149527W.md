# A0149527W
###### CS2103\bin\view\html\help.html
``` html
 body{
 	background: rgba(0,0,0,0);
 }
 #wrapper{
 	margin:0 auto;
 }
 .center {
 	width: 700px;
 }
 .tut{
 	height:653px;
 	padding: 15px;
 	padding-right: 5px;
 	background-color:rgba(238,238,238,1.0);
 	overflow-y: scroll;
 }
 .commandline{
 	background-color: #726e6e;
 	height: 55px;
 }
 .panel-heading{
 	background-color: #3273b1;
 	color: #fff;
 }
 h1{
 	color: #3273b1;
 	font-weight: 600;
 }
 form{
 	width: 100%;
 	height: 100%;
 }
 input{
 	width: 100%;
 	height: 100%;
 	background: transparent;
 	color: #fff;
 	border: 0;
 	outline:none;
 	line-height: 30px;
 	font-size: 20px;
 	padding: 15px;
 }
 .page-header,.panel-heading{
 	text-align: center;
 }
 #suggestion-bar{
    width: 700px;
    display: none;
  }
  .arrow-up {
    width: 0;
    height: 0;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-bottom: 7px solid #333;
    position: relative;
    left: 30px;
  }
  .command_suggestion{
    height: 35px;
    background-color: #333;
    width: 100%;
    border-radius: 10px;
    color: #ddd;
    font-size: 18px;
    padding: 5px 15px;
  }
</style>
</head>
<body scroll="no">
	<script>

		function shortCutCommand(cmd){
			app.receiveCommand(cmd);
		}

		function sendCommand() {
			var command = cmd.elements['command'].value;
		  // Invoke the 'receive' Java callback
		  app.receiveCommand(command);
		}

		function clearCommandLine(){
			$(command).val("");
		}

//Prevent the backspace key from navigating back.
$(document).unbind('keydown').bind('keydown', function (event) {
	var doPrevent = false;
	if (event.keyCode === 8) {
		var d = event.srcElement || event.target;
		if ((d.tagName.toUpperCase() === 'INPUT' && 
			(
				d.type.toUpperCase() === 'TEXT' ||
				d.type.toUpperCase() === 'PASSWORD' || 
				d.type.toUpperCase() === 'FILE' || 
				d.type.toUpperCase() === 'SEARCH' || 
				d.type.toUpperCase() === 'EMAIL' || 
				d.type.toUpperCase() === 'NUMBER' || 
				d.type.toUpperCase() === 'DATE' )
			) || 
			d.tagName.toUpperCase() === 'TEXTAREA') {
			doPrevent = d.readOnly || d.disabled;
	}
	else {
		doPrevent = true;
	}
}
if (doPrevent) {
	event.preventDefault();
}
});

$(document).keydown(
	function(e)
	{   
		switch(e.keyCode){
        case 32://space bar
        var d = e.srcElement || e.target;
        if (d.tagName.toUpperCase() != 'INPUT'){
        	$(command).focus();
        	$(command).val("");
        }
        break;
}
		});

function getCommandsuggestion()
{
	if(cmd.elements['command'].value==''){
		$("#suggestion-bar").hide();
	}

  //send command when typing
  if(app.getCommandsuggestion(cmd.elements['command'].value)!=''){
  	$("#suggestion-bar").show();
  	$("#suggstion").text(app.getCommandsuggestion(cmd.elements['command'].value));
  }else{
  	$("#suggestion-bar").hide();
  }
  
};
</script>
<div id="wrapper">
	<div class="center">
		<div class="main">
			<div class="tut">
				<div class="page-header">
					<h1>J.Listee <small>Your Personal To-Do Manager</small></h1>
				</div>
				<div class="panel panel-default">
					<!-- Default panel contents -->
					<div class="panel-heading" style="background-color: #3273b1; color: #fff;font-size:20px;">Features and Commands</div>
					<div class="panel-body">
						<p>J.Listee is a GTD desktop application which can help you to manage your to-do list. </p>
						<p><strong>Features include:</strong>
							<br>&diams;&nbsp;   create a task with or without date and time
							<br>&diams;&nbsp;   edit an existing task
							<br>&diams;&nbsp;    delete existing tasks
							<br>&diams;&nbsp; 	search tasks by keywords or by group
							<br>&diams;&nbsp; 	postpone a task
							<br>&diams;&nbsp; 	reserve time slots for a task
							<br>&diams;&nbsp; 	confirm a time slot for a reserved task
							<br>&diams;&nbsp; 	mark a task as done/undone
							<br>&diams;&nbsp; 	undo/redo previous commands
							<br>&diams;&nbsp; 	change storage location
						</p>
					</div>

					<!-- Table -->
					<table class="table">
						<thead>
							<tr>
								<th>#</th>
								<th>Command format</th>
								<th>Example</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th scope="row">1</th>
								<td>&lt;add> [description] [&lt;preposition> time] [@location] [#tags<br>(for deadline)</td>
								<td>add good friday this friday @home #yay #study</td>
							</tr>
							<tr>
								<th scope="row">2</th>
								<td>&lt;add> [description] [&lt;from> start time &lt;to> end time] [*@*location] [#tag]<br>(for event)</td>
								<td>add meeting with prof @com1 #work from 1st april 2pm to 5th april 3pm</td>
							</tr>
							<tr>
								<th scope="row">3</th>
								<td>&lt;add> [description] [@location] [#tags]<br>(for untimed)</td>
								<td> add @room clean</td>
							</tr>
							<tr>
								<th scope="row">4</th>
								<td>&lt;del> or &lt;delete> &lt;starting task number - ending task number><br>&lt;del> or &lt;delete> &lt;tasknumber, tasknumber, tasknumber></td>
								<td>delete 1-3, 5 <br> delete 1,2,3,4,5 <br>delete 1-5</td>
							</tr>
							<tr>
								<th scope="row">5</th>
								<td>&lt;update> &lt;task number > [&lt;/timegroup> time] [task description] [@location] OR [-@] [#hashtags][-#deletehashtags]<br>(not for reserved)</td>
								<td>update 2 more work /end tonight 2359<br>edit 2 /both today from 3pm to 6pm -@</td>
							</tr>
							<tr>
								<th scope="row">6</th>
								<td>&lt;update> &lt;task number > [&lt;reservation index> &lt;[-]/timegroup [time]> [task description] [@location] OR [-@] [#hashtags][-#deletehashtags]<br>(for reserved)</td>
								<td>update 1 1 / start today 4pm<br>edit 2 meeting manager @ofï¬?ce<br>edit 3 -start</td>
							</tr>
							<tr>
								<th scope="row">7</th>
								<td>&lt;show> [task description] [/taskgroup][&lt;preposition> time] [@location] [#hashtags]</td>
								<td>show assignment due friday</td>
							</tr>
							<tr>
								<th scope="row">8</th>
								<td>&lt;undone> or &lt;done> &lt;starting task number - ending task number><br>&lt;undone> or &lt;done> tasknumber, tasknumber, tasknumber></td>
								<td>done 1-3, 5 <br>undone 1,2,3,4,5 <br>undone 1-5</td>
							</tr>
							<tr>
								<th scope="row">9</th>
								<td>&lt;postpone> &lt;task number> &lt;time></td>
								<td> postpone 2 2hours 4mins<br>postpone 3 3years</td>
							</tr>
							<tr>
								<th scope="row">10</th>
								<td>reserve &lt;task description> [&lt;from> start time &lt;to> end time] [and/or] [&lt;from> start time &lt;to> end time] [@location] [#hashtags]</td>
								<td>reserve meet friends from thursday 4pm to thursday 6pm or friday 4pm to 6pm #dinner</td>
							</tr>
							<tr>
								<th scope="row">11</th>
								<td>conï¬?rm &lt;conï¬?rm> &lt;tasknumber> &lt;reserve task index></td>
								<td>confirm 2, 3</td>
							</tr>
							<tr>
								<th scope="row">12</th>
								<td>undo or redo</td>
								<td>undo<br>redo</td>
							</tr>
							<tr>
								<th scope="row">13</th>
								<td>change filepath</td>
								<td>change filepath</td>
							</tr>
							<tr>
								<th scope="row">14</th>
								<td>help</td>
								<td>help</td>
							</tr>
							<tr>
								<th scope="row">15</th>
								<td>exit</td>
								<td>exit</td>
							</tr>
						</tbody>
					</table>
					<div class="panel-body">
					</div>
					<table class="table">
						<thead>
							<tr>
								<th>Task group for show/search</th>
								<th>Prepositions before time</th>
								<th>Time group for update</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>/today</td>
								<td> fromâ€¦toâ€¦ </td>
								<td>/end</td>
							</tr>
							<tr>
								<td>/tomorrow</td>
								<td> by </td>
								<td>/start</td>
							</tr>
							<tr>
								<td>/overdue</td>
								<td> on </td>
								<td>/etime</td>
							</tr>
							<tr>
								<td>/done</td>
								<td> at </td>
								<td>/stime</td>
							</tr>
							<tr>
								<td>/reserved</td>
								<td> due </td>
								<td>-alltime</td>
							</tr>
							<tr>
								<td>/events</td>
								<td> during </td>
								<td>-end</td>
							</tr>
							<tr>
								<td>/deadlines</td>
								<td> in </td>
								<td>-start</td>
							</tr>
							<tr>
								<td>/untimed</td>
								<td> for </td>
								<td>/both</td>
							</tr>
							<tr>
								<td></td>
								<td> this </td>
								<td></td>
							</tr>
							<tr>
								<td></td>
								<td> before </td>
								<td></td>
							</tr>
							<tr>
								<td></td>
								<td> after </td>
								<td></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>		
		</div>
		<div class="commandline">
			<form name="cmd">
				<input type="text" name="command" id="command" onkeyup="getCommandsuggestion();" onkeydown="if(event.keyCode==13){sendCommand();}" placeholder="Type 'back' here" autofocus/>
			</form>
		</div>
	</div>
	<div id="suggestion-bar">
  <div class="arrow-up"></div>
  <div class="command_suggestion" id="suggstion"></div>
</div>
</div>
</body>
</html>
```
###### CS2103\bin\view\html\launch.html
``` html
  body{
	    background: rgba(0,0,0,0);
	  }
   #wrapper{
     margin:0 auto;
     height: 600px;
   }
   .center {
     width: 700px;
     height: 100%;
     text-align: center;
   }
   .btn-lg{
    width: 80%;
    font-size: 25px;
   }
   h1{
    font-size: 60px;
   }
   .jumbotron{
    width: 100%;
    height:100%;
    padding: 50px;
    margin-bottom: 0px;
   }
 </style>
</head>
<body>
	<script>
    function chooseFolder() {
   // Call Java callback function and pass text fields values.
   app.chooseFolder();
 }
</script>
	<div id="wrapper">
		<div class="center">
			<div class="jumbotron">
				<br> <br>
				<h1>Welcome to J.Listee!</h1>
				<p>
					<br>
					<br>Now please specify a folder as the data storage location.
					You can use a cloud syncing service to control your to-do list.
				</p>
				<br> <br> <br>
				<p>
					<a class="btn btn-primary btn-lg" href="#" role="button"
						onclick="chooseFolder();">Choose a folder</a>
				</p>
				<br>
			</div>
		</div>
	</div>
</body>
</html>
```
###### CS2103\bin\view\html\list.html
``` html
  body{
    background: rgba(0,0,0,0);
  }
   .center {
     width: 700px;
     text-align: center;
   }
   .list{ 
    height:653px;
    padding: 8px 15px;
    padding-right: 5px;
    background-color:rgba(238,238,238,1.0);
    overflow-y:scroll;
  }

  .commandline{
    background-color: #726e6e;
    height: 55px;
  }
  .grouptitle{
    font-size: 23px;
    color: #888;
    font-weight: 100;
  }
  .title{
    font-size: 25px;
    color: #555;
    font-weight: 100;
  }
  section{
    display: inline-block;
  }
  .task{
    width: 100%;
    height:58px;
    border-radius: 8px;
    background-color: rgba(255,255,255,0.7);
    margin: 1px 0 6px 0;
    vertical-align: middle;
  }
  .task:focus{
    background-color: rgba(255,255,255,1.0);
    outline: 0;
    border-radius: 8px;
    box-shadow: 0 0 0 1.5px #ccc;
  }
  .overdue:focus{
    background-color: rgba(235,131,99,0.3);
  }
  .conflict{
    outline: 0;
    border-radius: 8px;
    box-shadow: 0 0 0 1.5px #ccc;
  }
  .task_number{
    width:8%;
    height: 100%;
    border-radius: 8px 0 0 8px;
    background-color: rgba(131,207,203,0.8);
    font-size: 35px;
    line-height: 58px;
    color: #444;
    float: left;
  }
  .overdue .task_number{
    background-color: rgba(235,131,99,0.8);
  }
  .overdue {
    background-color: rgba(235,131,99,0.25);
  }
  .task_middle{
    display:table;
    float: left;
    width:69.5%;
    height: 100%;
    text-align: left;
    padding:4px 0px 3px 10px;
  }
  .task_right{
    float: right;
    height: 100%;
    display: table;
    width: 22.5%;
    padding: 5px 8px 5px 5px;
    text-align: right;
  }

  .task_description{
    font-size: 18px;
  }
  .time{
    font-size: 14px;
  }
  .time>div{
    vertical-align: middle;
    display: table-cell;
    padding: 0 4px;
  }
  .time span{
    padding: 0px 8px;
    display: block;
    border-radius: 3px;
  }
  .task_components,.task_location,.task_tags{
    margin: 4px 5px 4px 0px;
  }
  .task_middle .task_components{
    display:table-row;
    height: 50%;
  }
  #description{
    display: table-cell;
    vertical-align: middle;
  }
  .task_middle section,.task_middle span{
    line-height: 14px;
    height:20px;
    border-radius: 3px;
    padding: 2px;
    text-align: center;
  }
  .task_location{    
    background-color: rgba(63,190,122,0.4);    
  }
  .task_tags span{
    background-color: #d8d8d8;
    margin-right: 5px;
  }
  .task_right>div{
    display: table-row;
  }
  .task_lowertime span{
    background-color: rgba(240,108,125,0.4);
  }
  .task_uppertime span{
    background-color: rgba(0,181,242,0.4);
  }
  .overdue span{
    background-color: rgba(255,255,255,0.5);
  }
  #tasklist_deadline .time{
    position: relative;
    top: 23%;
  }
  form{
    width: 100%;
    height: 100%;
  }
  input{
    width: 100%;
    height: 100%;
    background: transparent;
    color: #fff;
    border: 0;
    outline:none;
    line-height: 30px;
    font-size: 20px;
    padding: 15px;
  }
  .alert{
    position:absolute;
    display:none;
    bottom: 97px;
    margin-bottom: 0;
    width: 700px;
    height: 40px;
    padding: 10px;
  }
  .reserved .reserve_list{
    padding: 0;
    width: 100%;
    height: 100%;
    margin: 0 auto;
  }
  .timeslot{
    width: 33%;
    padding-right: 6px;
    float: right;
    height: 58px;
    background-color: #dfdfdf;
    margin-left: 1px;
  }
  .reserved .task_middle{
    width:35%;
  }
  .reserved .task_right{
    padding: 0;
    width: 57%;
  }
  #timeslot1{
    border-radius: 0 8px 8px 0;
  }
  #suggestion-bar{
    width: 700px;
    display: none;
  }
  .arrow-up {
    width: 0;
    height: 0;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-bottom: 7px solid #333;
    position: relative;
    left: 30px;
  }
  .command_suggestion{
    height: 35px;
    background-color: #333;
    width: 100%;
    border-radius: 10px;
    color: #ddd;
    font-size: 18px;
    padding: 5px 15px;
  }
 .index{
 	width: 12px;
    font-size: 12px;
    text-align: center;
    float: left;
    color: white;
    border-radius: 3.5px;
    background-color: rgba(114, 110, 110,0.4);
 }
</style>
</head>
<body>
  <script  type="text/javascript">
    var i=0;

    function reset(){
      i=0;
    }

    function reload() {
      window.location.reload();
    }
    
    function addReservedTask(jsonTasks){
      var taskList = JSON.parse(jsonTasks);

      if(taskList.length==0)
        return;

      var tasklist_=document.getElementById("tasklist_reserved");
      $(reserved_title).text("Reserved");
      
      //remove all existing children
      while (tasklist_.firstChild) {
        tasklist_.removeChild(tasklist_.firstChild);
      }

      for  (index = 0; index < taskList.length; index++){

        var taskdiv = document.createElement("div");
        taskdiv.setAttribute("class", "task");
        taskdiv.setAttribute("tabindex", "0");
        taskdiv.setAttribute("id", i+1);

        var detail="Description: "+taskList[index].description;
        taskdiv.setAttribute("data-toggle","tooltip");
        taskdiv.setAttribute("data-placement","auto");

        //restric displaying discription length
        var description="";
        if(taskList[index].description.length<24){
          description=taskList[index].description;
        }else{
          description=taskList[index].description.substring(0,23)+"...";
        }

        taskdiv.innerHTML= "<section class='task_number'>"
        + (i+1)
        + "</section>"
        + "<section class='task_middle' id='task_middle'>"
        + "<div class='task_components task_description' id='task_description"
        + i
        + "'>"
        + "<div id='description'>"
        + description
        +"</div>"
        + "</div>"
        + "<div class='task_components' id='task_details"
        + i
        +"'>"
        + "<section class='task_location' id='task_location"
        + i
        +"'>"

        + "</section>"
        + "<section class='task_tags' id='task_tags"
        + i
        +"'>"

        + "</section>"
        + "</div>"
        + "</section>"
        + "<section class='task_right'>"
        + "<div class='reserve_list' id='timeslot_list"
        + i
        +"'>"
        + "</div> "
        + "</section>"

        tasklist_.appendChild(taskdiv);

        var task_location=document.getElementById("task_location"+i);
        var task_tags=document.getElementById("task_tags"+i);
        var task_details=document.getElementById("task_details"+i);
        var timeslot_list=document.getElementById("timeslot_list"+i);

        if(taskList[index].location==undefined && taskList[index].tags.length==0){
          task_details.style.display="none";
        }else{
         //add location if necessary
         if(taskList[index].location!=undefined){
           var locationspan = document.createElement("span");
           locationspan.innerHTML="@"+taskList[index].location;
           task_location.appendChild(locationspan);

           detail=detail+"<br>Location: "+taskList[index].location;
         }
         else{
           task_location.style.display="none";
         }

         //add tags if necessary at most 3
         if(taskList[index].tags.length>0){

          detail=detail+"<br>"+"Tags: ";
          for  (index2 = 0; index2 < taskList[index].tags.length; index2++){
            detail=detail+"#"+taskList[index].tags[index2]+", ";
          }

          if(taskList[index].tags.length>3){
            taskList[index].tags[2]="...";
          }
          
          for  (index2 = 0; index2 < taskList[index].tags.length && index2 < 3; index2++){
           var tagspan = document.createElement("span");
           tagspan.innerHTML="#"+taskList[index].tags[index2];
           task_tags.appendChild(tagspan);
          }
         }
         else{
           task_tags.style.display="none";
         }
        }
        var len=taskList[index].startDates.length;
        detail=detail+"<br>Time slots: ";

        for( index3 =0; index3 < len; index3++){
          detail+="<br>("+taskList[index].startDates[index3]+", "+taskList[index].endDates[index3]+")";
        }

        taskdiv.setAttribute("title","<h5 style='text-align:left; overflow: hidden; overflow-wrap: break-word;'>"+detail+"</h5>");

        //add timeslots at most 3
        for( index3 =len-1; index3>=0 && len-index3<4; index3--){
           var timeslot = document.createElement("div");
           timeslot.setAttribute("class", "timeslot");
           timeslot.setAttribute("id", "timeslot"+(index3));
           timeslot.innerHTML="<div class='index'>"+(index3+1)+"</div>"+"<div style='margin: 8px 0 0;'>"+taskList[index].startDates[index3]+"</div><div>"+taskList[index].endDates[index3]+"<div>";
           timeslot_list.appendChild(timeslot);
        }

        i=i+1;
      }
     $("[data-toggle='tooltip']").tooltip({html : true }); 
    }

    function addTasks(jsonTasks, type){
      var taskList = JSON.parse(jsonTasks);
     
      if(taskList.length==0)
        return;

      if(type=="deadline"){
        var tasklist_=document.getElementById("tasklist_deadline");
        $(deadline_title).text("Deadlines");
      }else if(type=="event"){
        var tasklist_=document.getElementById("tasklist_event");
        $(event_title).text("Events");
      }else if(type=="floating"){
        var tasklist_=document.getElementById("tasklist_floating");
        $(float_title).text("Untimed");
      }else if(type=="completed"){
        var tasklist_=document.getElementById("tasklist_mixed");
        $(title).text("Completed Tasks");
      }

    //remove all existing children
    while (tasklist_.firstChild) {
      tasklist_.removeChild(tasklist_.firstChild);
    }

    for  (index = 0; index < taskList.length; index++){

      //restric displaying discription length
      var description="";
      if(taskList[index].description.length<50){
        description=taskList[index].description;
      }else{
        description=taskList[index].description.substring(0,49)+"...";
      }

      var taskdiv = document.createElement("div");
      if(taskList[index].overdue==true){
        taskdiv.setAttribute("class", "task overdue");
      }else{
        taskdiv.setAttribute("class", "task");
      }
      taskdiv.setAttribute("tabindex", "0");
      taskdiv.setAttribute("id", i+1);

      var detail="Description: "+taskList[index].description;
      taskdiv.setAttribute("data-toggle","tooltip");
      taskdiv.setAttribute("data-placement","auto");

      taskdiv.innerHTML= "<section class='task_number'>"
      + (i+1)
      +"</section>"
      + "<section class='task_middle' id='task_middle'>"
      + "<div class='task_components task_description' id='task_description"
      + i
      + "'>"
      + "<div id=description>"
      + description
      + "</div>"
      +"</div>"
      + "<div class='task_components' id='task_details"
      + i
      +"'>"
      + "<section class='task_location'id='task_location"
      + i
      +"'>"

      +"</section>"
      + "<section class='task_tags' id='task_tags"
      + i
      +"'>"
      + "</div>"
      + "</section>"
      + "</section>"
      + "<section class='task_right'>"
      + "<div class='task_components time task_uppertime' id='task_start_div"
      + i
      + "'>"
      + "<div>"
      + "<span id='task_start"
      + i
      + "'>"
      + "</span>"
      + "</div>"
      +"</div>"
      + " <div class='task_components time task_lowertime' id='task_end_div"
      + i
      + "'>"
        + "<div>"
      + "<span id='task_end"
      + i
      + "'>"
      + "</span>"
      + "</div>"
      +"</div>"
      + "</section>"

      tasklist_.appendChild(taskdiv);

      var task_location=document.getElementById("task_location"+i);
      var task_start=document.getElementById("task_start"+i);
      var task_end=document.getElementById("task_end"+i);
      var task_tags=document.getElementById("task_tags"+i);
      var task_details=document.getElementById("task_details"+i);

      if(taskList[index].location==undefined && taskList[index].tags.length==0){
        task_details.style.display="none";
      }else{
         //add location if necessary
         if(taskList[index].location!=undefined){
           var locationspan = document.createElement("span");
           locationspan.innerHTML="@"+taskList[index].location;
           task_location.appendChild(locationspan);

           detail=detail+"<br>Location: "+taskList[index].location;
         }
         else{
           task_location.style.display="none";
         }

         //add tags if necessary
         if(taskList[index].tags.length!=0){

          detail=detail+"<br>"+"Tags: ";
          for  (index2 = 0; index2 < taskList[index].tags.length; index2++){
            detail=detail+"#"+taskList[index].tags[index2]+", ";
          }

          if(taskList[index].tags.length>4){
            taskList[index].tags[3]="...";
          }          
          for  (index2 = 0; index2 < taskList[index].tags.length && index2 < 4; index2++){
           var tagspan = document.createElement("span");
           tagspan.innerHTML="#"+taskList[index].tags[index2];
           task_tags.appendChild(tagspan);        
         }
       }
       else{
         task_tags.style.display="none";
       }
     }


     //add startDate if necessary
     if(taskList[index].startDate!=undefined){        
       task_start.innerHTML=taskList[index].startDate;

       detail=detail+"<br>Start Date: "+taskList[index].startDate;
     }
     else{
       $("#task_start_div"+i).hide();
     }

     //add endDate if necessary
     if(taskList[index].endDate!=undefined){
       task_end.innerHTML= taskList[index].endDate;
       detail=detail+"<br>End Date: "+taskList[index].endDate;
     }
     else{
       $("#task_end_div"+i).hide();
     }

     taskdiv.setAttribute("title","<h5 style='text-align:left; overflow: hidden; overflow-wrap: break-word;'>"+detail+"</h5>");

     i=i+1;
   }    
   $("[data-toggle='tooltip']").tooltip({html : true }); 
 }

 function sendCommand() {
  var command = cmd.elements['command'].value;
  // Invoke the 'receive' Java callback
  app.receiveCommand(command);
  }

function shortCutCommand(cmd){
  app.receiveCommand(cmd);
}

function showFeedBack(feedback){
  $("#feedback").text(feedback);
  $("#feedback").slideToggle("slow");
  setTimeout("hideFeedBack()",2500);
}

function hideFeedBack(){
  $("#feedback").slideToggle();
}

function setFocus(indices){
  var indexList = JSON.parse(indices);

  for(var i=0;i<indexList.length;i++){
    $("#"+indexList[i]).focus();
  }
}

function showConflict(conflics){
  setTimeout(
    function (){
  var indexList = JSON.parse(conflics);

  for(var i=0;i<indexList.length;i++){
    $("#"+indexList[i]).fadeOut(200).fadeIn(200).fadeOut(200).fadeIn(200);
  }
},1000);
}

function addShowAnimation(indices){
  var indexList = JSON.parse(indices);

  for(var i=0;i<indexList.length;i++){
    $("#"+indexList[i]).hide();
  }

  for(var i=0;i<indexList.length;i++){
    $("#"+indexList[i]).toggle(900);
  }
}

function addHideAnimation(indices){
  var indexList = JSON.parse(indices);

  for(var i=0;i<indexList.length;i++){
    var j=parseInt(indexList[i])-i;
    $("#"+j).toggle(900);

    $("#"+j).attr("id",0);
    var index=j+1;
    //update indices of flollowing tasks
    while($("#"+index).length){
      $("#"+index).children("section.task_number").text(index-1);
      $("#"+index).attr("id",index-1);

      index=index+1;
    }
  }
}

function clearCommandLine(){
  $(command).val("");
}

//Prevent the backspace key from navigating back.
$(document).unbind('keydown').bind('keydown', function (event) {
    var doPrevent = false;
    if (event.keyCode === 8) {
        var d = event.srcElement || event.target;
        if ((d.tagName.toUpperCase() === 'INPUT' && 
             (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'NUMBER' || 
                 d.type.toUpperCase() === 'DATE' )
             ) || 
             d.tagName.toUpperCase() === 'TEXTAREA') {
            doPrevent = d.readOnly || d.disabled;
        }
        else {
            doPrevent = true;
        }
    }
    if (doPrevent) {
        event.preventDefault();
    }
});


function getCommandsuggestion()
{
  if(cmd.elements['command'].value==''){
    $("#suggestion-bar").hide();
  }

  //send command when typing
  if(app.getCommandsuggestion(cmd.elements['command'].value)!=''){
    $("#suggestion-bar").show();
    $("#suggstion").text(app.getCommandsuggestion(cmd.elements['command'].value));
  }else{
    $("#suggestion-bar").hide();
  }
  
};

function hideSuggestion(){
  $("#suggestion-bar").hide();
}

$(document).keydown(
    function(e)
    {   
      switch(e.keyCode){
        case 32://space bar
          var d = e.srcElement || e.target;
           if (d.tagName.toUpperCase() != 'INPUT'){
            $(command).focus();
            $(command).val("");
          }
        break;
        case 40://key down
          var d = e.srcElement || e.target;
           if (d.tagName.toUpperCase() == 'INPUT')
           {
            $("#command").val(app.getLaterCmd());
           }else{
              if($(".task:focus").length==0){
                $(".task:last").focus();
              }else{
                var id=parseInt($(".task:focus")[0].id)+1;
                if(id==$(".task").length+1)
                  id=1;
                $("#"+id).focus();
              }   
           }
        break;
        case 38://key up
           var d = e.srcElement || e.target;
           if (d.tagName.toUpperCase() == 'INPUT')
           {
              $("#command").val(app.getPreviousCmd());
           }else{
              if($(".task:focus").length==0){
                $(".task:first").focus();
              }else{ 
                var id=parseInt($(".task:focus")[0].id)-1;
                if(id==0)
                  id=$(".task").length;
                $("#"+id).focus();
              }
           }
        break;
        case 46://delete
        case 8://backspace
          if($(".task:focus").length>0){
            var id=parseInt($(".task:focus")[0].id);
            console.log("delete "+id);
            shortCutCommand("delete "+id);
          }
        break;
        case 88://x
          if($(".task:focus").length>0){
            var id=parseInt($(".task:focus")[0].id);
            if($(title).text()=="Completed Tasks"){
              shortCutCommand("undone "+id);
            }else{
              shortCutCommand("done "+id);
            }            
          }
          break;
        case 80://p
          if($(".task:focus").length>0){
            var id=parseInt($(".task:focus")[0].id);
            shortCutCommand("postpone "+id);
          }
        break;
        case 90://ctrl+z
        	if(e.ctrlKey)
        		shortCutCommand("undo");
        break;
        case 89://ctrl+y
        	if(e.ctrlKey)
        		shortCutCommand("redo");
      }
    }
);

    $(function () { 
      $("[data-toggle='tooltip']").tooltip({html : true }); 
    });
</script>

<div id="wrapper">
 <div class="center">
  <div class="main">
    <div class="alert alert-success" id="feedback" role="alert"></div>
    
    <div class="list">
      <div class="title" id="title"></div>
      <div class="group deadline">
        <div class="grouptitle" id="deadline_title"></div>
        <div class="tasklist" id="tasklist_deadline">

        </div>
      </div>

      <div class="group event">
        <div class="grouptitle" id="event_title"></div>
        <div class="tasklist" id="tasklist_event">

        </div>
      </div>

      <div class="group floating">    
       <div class="grouptitle" id="float_title"></div> 
       <div class="tasklist" id="tasklist_floating">

       </div>
     </div>
     <div class="group reserved">    
       <div class="grouptitle" id="reserved_title"></div> 
       <div class="tasklist" id="tasklist_reserved">
          </div>
     </div>
    <div class="group mixed">
        <div class="grouptitle" id="mixed_title"></div>
        <div class="tasklist" id="tasklist_mixed">

        </div>
      </div>
   </div>
   <div class="commandline">
    <form name="cmd">
      <input type="text" name="command" id="command" onkeydown="if(event.keyCode==13){sendCommand();}" onkeyup="getCommandsuggestion();" placeholder="Type your command here" autofocus/>
    </form>
  </div>
</div>
</div>
<div id="suggestion-bar">
  <div class="arrow-up"></div>
  <div class="command_suggestion" id="suggstion"></div>
</div>

</div>
</body>
</html>
```
###### CS2103\src\gui\AppPage.java
``` java
 */
public abstract class AppPage extends StackPane {
	WebView browser;
	WebEngine webEngine;
	String html;

	public AppPage(String html) {
		this.browser = new WebView();
		this.webEngine = browser.getEngine();
		this.html = html;
		browser.setContextMenuEnabled(false);
		this.setStyle("-fx-background-color: rgba(0, 0, 0, 0); ");

		webEngine.documentProperty().addListener(new DocListener());

		// load web page
		webEngine.load(WelcomeAndChooseStorage.class.getResource(this.html)
				.toExternalForm());

		// add the web view to the scene
		this.getChildren().add(browser);
	}

	class DocListener implements ChangeListener<Document> {
		@Override
		public void changed(ObservableValue<? extends Document> observable,
				Document oldValue, Document newValue) {
			try {

				// Use reflection to retrieve the WebEngine's private 'page'
				// field.
				Field f = webEngine.getClass().getDeclaredField("page");
				f.setAccessible(true);
				com.sun.webkit.WebPage page = (WebPage) f.get(webEngine);
				page.setBackgroundColor((new java.awt.Color(0, 0, 0, 0))
						.getRGB());

			} catch (Exception e) {
			}

		}
	}
}
```
###### CS2103\src\gui\GUIController.java
``` java
 */
public class GUIController {
	private static Stage stage;
	private static final int WINDOW_WIDTH = 800;
	private static final int WINDOW_HEIGHT = 750;

	private static AppPage welcome;
	private static AppPage showList;
	private static AppPage help;

	public static void setStage(Stage stage2) {
		stage = stage2;
	}

	/**
	 * create J.Listee file under the given file path
	 * 
	 * @throws IOException
	 *             if file can not be created
	 */
	public static void createFile(String userChosenfile) throws IOException {
		LogStorage.writeLogFile(userChosenfile);
		if (!Logic.createFile(userChosenfile)) {
			throw new IOException("Error: Cannot create file!");
		}
	}

	/**
	 * display welcome page in the frame
	 */
	public static void displayWelcome() {
		Scene scene = stage.getScene();
		welcome = new WelcomeAndChooseStorage();
		if (scene == null) {
			scene = new Scene(welcome, WINDOW_WIDTH, WINDOW_HEIGHT);
			scene.setFill(null);
			setMouseMovable(scene);
			setShortcut(scene);
			stage.setScene(scene);
		} else {
			stage.getScene().setRoot(welcome);
		}
		stage.sizeToScene();
		stage.show();
	}

	/**
	 * display list page in the frame
	 * 
	 * @param display
	 * @return
	 */
	public static void displayList(Display display) {
		Scene scene = stage.getScene();

		((ShowList) showList).setList(display);

		if (scene != null && scene.getRoot() != showList) {
			stage.getScene().setRoot(showList);
			stage.show();
			return;
		}

		if (scene == null) {
			scene = new Scene(showList, WINDOW_WIDTH, WINDOW_HEIGHT);
			scene.setFill(null);
			setMouseMovable(scene);
			setShortcut(scene);
			stage.setScene(scene);
		}
		stage.sizeToScene();
		stage.show();
	}

	/**
	 * display help page in the frame
	 * 
	 * @param display
	 * @return
	 */
	public static void displayHelp() {
		Scene scene = stage.getScene();
		help= new Help();
		
		if (scene == null) {
			scene = new Scene(help, WINDOW_WIDTH, WINDOW_HEIGHT);
			scene.setFill(null);
			setMouseMovable(scene);
			setShortcut(scene);
			stage.setScene(scene);
		} else {
			stage.getScene().setRoot(help);
		}
		stage.sizeToScene();
		stage.show();
	}

	/**
	 * set esc on close
	 * 
	 * @param stage
	 * @param scene
	 */
	private static void setShortcut(Scene scene) {
		scene.addEventHandler(KeyEvent.KEY_PRESSED,
				new EventHandler<KeyEvent>() {
					@Override
					public void handle(KeyEvent e) {
						if (e.getCode() == KeyCode.ESCAPE) {
							App.terminate();
						}
					}
				});
	}

	/**
	 * add mouse listener to scene
	 */
	private static void setMouseMovable(Scene scene) {
		scene.addEventFilter(MouseEvent.MOUSE_PRESSED,
				new EventHandler<MouseEvent>() {
					@Override
					public void handle(MouseEvent event) {
						App.xOffset = event.getSceneX();
						App.yOffset = event.getSceneY();
					}
				});
		scene.addEventFilter(MouseEvent.MOUSE_DRAGGED,
				new EventHandler<MouseEvent>() {
					@Override
					public void handle(MouseEvent event) {
						stage.setX(event.getScreenX() - App.xOffset);
						stage.setY(event.getScreenY() - App.yOffset);
					}
				});
	}

	/**
	 * initialize the start page which display deadlines, events and floating
	 * tasks
	 */
	public static void initializeList(String filePath) {
		// call to logic to get all the tasks
		Display display = Logic.initializeProgram(filePath);
		// assert display!=null :"Display is null!";
		if (display == null)
			JOptionPane.showMessageDialog(null, "display is null!");
		showList = new ShowList(display);
		displayList(display);
	}

	public static void handelUserInput(String command) {
		Display display = Logic.executeUserCommand(command);
		// assert display!=null :"Display is null!";
		if (display == null)
			JOptionPane.showMessageDialog(null, "display is null!");
		displayList(display);
	}

	public static AppPage getShowList() {
		return showList;
	}

	public static void changeFilePath(String filePath) {
		Display display = Logic.changeFilePath(filePath);
		// assert display!=null :"Display is null!";
		if (display == null)
			JOptionPane.showMessageDialog(null, "display is null!");
		displayList(display);
	}

}
```
###### CS2103\src\gui\Help.java
``` java
 */
public class Help extends AppPage {
	private InputSuggestion suggestion = InputSuggestion.getInstance();

	public Help() {
		super("/view/html/help.html");
		JSObject win = (JSObject) webEngine.executeScript("window");
		win.setMember("app", new HelpBridge());
	}

	// JavaScript interface object
	public class HelpBridge {

		public void receiveCommand(String command) {
			String cmd = command.trim();
			GUIController.handelUserInput(cmd);
		}

		public String getCommandsuggestion(String cmd) {
			String cmdSuggestion = suggestion.getSuggestedInput(cmd.trim());
			if (cmdSuggestion.equals(new String("null")) == false) {
				return cmdSuggestion;
			} else {
				return "";
			}
		}
	}

}
```
###### CS2103\src\gui\ShowList.java
``` java
 */
public class ShowList extends AppPage {
	private List<String> userCmd = new ArrayList<String>();// store user's
															// commands
	private int cmdIndex;// the presenting cmd's index
	private Display display = new Display();
	private JSObject win;
	private InputSuggestion suggestion = InputSuggestion.getInstance();

	public ShowList(Display display) {
		super("/view/html/list.html");
		this.display = display;
		addLoadListener();
	}

	/**
	 * add load listener to webengine
	 */
	private void addLoadListener() {
		webEngine
				.getLoadWorker()
				.stateProperty()
				.addListener(
						(ObservableValue<? extends State> ov, State oldState,
								State newState) -> {
							if (newState == Worker.State.FAILED) {
								webEngine.load(WelcomeAndChooseStorage.class
										.getResource(this.html)
										.toExternalForm());
							}
							if (newState == Worker.State.SUCCEEDED) {
								this.win = (JSObject) webEngine
										.executeScript("window");
								win.setMember("app", new ListBridge());

								resetTaskNumber();

								// construct JSON to pass to JS and call add
								// task
								addTasks();

								setMessageAndAnimation();
							}
						});
	}

	/**
	 * set message and animation in display
	 */
	private void setMessageAndAnimation() {
		setMessage();

		JSONArray jsonFocus = constructFocusArray();

		setAddAnimation(jsonFocus);
		setFocusAnimation(jsonFocus);
		setConflictAnimation();
	}

	/**
	 * add all sorts of tasks
	 */
	private void addTasks() {
		addDeadline();
		addEvent();
		addFloat();
		addReserved();
		addCompleted();
	}

	/**
	 * reset task number
	 */
	private void resetTaskNumber() {
		webEngine.executeScript("reset()");
	}

	/**
	 * set focus animation
	 * 
	 * @param jsonFocus
	 */
	private void setFocusAnimation(JSONArray jsonFocus) {
		win.call("setFocus", jsonFocus);
	}

	/**
	 * set conflict animation
	 */
	private void setConflictAnimation() {
		JSONArray jsonConflict = new JSONArray();
		for (int i = 0; i < this.display.getConflictingTasksIndices().size(); i++) {
			jsonConflict.put(this.display.getConflictingTasksIndices().get(i));
		}
		win.call("showConflict", jsonConflict);
	}

	/**
	 * set add animation
	 * 
	 * @param jsonFocus
	 */
	private void setAddAnimation(JSONArray jsonFocus) {
		if (this.display.getCommandType() == "Add") {
			win.call("addShowAnimation", jsonFocus);
		}
	}

	/**
	 * construct JSONArray for completed tasks and call js
	 */
	private void addCompleted() {
		if (this.display.getVisibleCompletedTasks() != null) {
			List<Task> completeds = this.display.getVisibleCompletedTasks();
			JSONArray jsonTask = new JSONArray();

			for (Task completed : completeds) {
				JSONObject task = constructJSON(completed);
				jsonTask.put(task);
			}
			win.call("addTasks", jsonTask, "completed");
		}
	}

	/**
	 * construct JSONArray for reserved tasks and call js
	 */
	private void addReserved() {
		if (this.display.getVisibleReservedTasks() != null) {
			List<TaskReserved> reservations = this.display
					.getVisibleReservedTasks();
			JSONArray jsonReserved = new JSONArray();
			for (TaskReserved reserved : reservations) {
				JSONObject task = new JSONObject(reserved);
				task.remove("startDates");
				task.remove("endDates");
				for (int i = 0; i < reserved.getStartDates().size(); i++) {
					try {
						task.append("startDates", new SimpleDateFormat(
								"EEE MM/dd HH:mm", Locale.ENGLISH)
								.format(reserved.getStartDates().get(i)
										.getTime()));
						task.append("endDates",
								new SimpleDateFormat("EEE MM/dd HH:mm",
										Locale.ENGLISH).format(reserved
										.getEndDates().get(i).getTime()));
					} catch (Exception e) {
						e.printStackTrace();
					}
				}
				jsonReserved.put(task);
			}
			win.call("addReservedTask", jsonReserved);
		}
	}

	/**
	 * construct JSONArray for floating tasks and call js
	 */
	private void addFloat() {
		if (this.display.getVisibleFloatTasks() != null) {
			List<TaskFloat> floatings = this.display.getVisibleFloatTasks();
			JSONArray jsonFloating = new JSONArray();
			for (Task floating : floatings) {
				JSONObject task = constructJSON(floating);
				jsonFloating.put(task);
			}
			win.call("addTasks", jsonFloating, "floating");
		}
	}

	/**
	 * construct JSONArray for event tasks and call js
	 */
	private void addEvent() {
		if (this.display.getVisibleEvents() != null) {
			List<TaskEvent> events = this.display.getVisibleEvents();
			JSONArray jsonEvent = new JSONArray();
			for (TaskEvent event : events) {
				JSONObject task = constructJSON(event);
				jsonEvent.put(task);
			}
			win.call("addTasks", jsonEvent, "event");
		}
	}

	/**
	 * construct JSONArray for deadline tasks and call js
	 */
	private void addDeadline() {
		// deadline tasks
		if (this.display.getVisibleDeadlineTasks() != null) {
			List<TaskDeadline> deadlines = this.display
					.getVisibleDeadlineTasks();
			JSONArray jsonDeadline = new JSONArray();
			for (TaskDeadline deadline : deadlines) {
				JSONObject task = constructJSON(deadline);
				jsonDeadline.put(task);
			}

			win.call("addTasks", jsonDeadline, "deadline");
		}
	}

	/**
	 * construct single task json to pass to javascript
	 * 
	 * @param completed
	 * @return
	 */
	private JSONObject constructJSON(Task completed) {
		JSONObject task = new JSONObject(completed);
		task.remove("startDate");
		task.remove("endDate");
		try {
			if (completed instanceof TaskEvent) {

				task.put("startDate", new SimpleDateFormat("EEE MM/dd HH:mm",
						Locale.ENGLISH).format(((TaskEvent) completed)
						.getStartDate().getTime()));
			}
			if (completed instanceof TaskDeadline
					|| completed instanceof TaskEvent) {
				task.put("endDate", new SimpleDateFormat("EEE MM/dd HH:mm",
						Locale.ENGLISH).format(((TaskDeadline) completed)
						.getEndDate().getTime()));
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
		return task;
	}

	public void setList(Display display) {
		if (this.display != null) {
			this.display = display;

			// add animation when deleting
			if (this.display.getCommandType() == "Delete") {
				setDeleteAnimation();
			} else {
				webEngine.reload();
			}
		}
	}

	public void setHtml(String html) {
		this.html = html;
		// load web page
		webEngine.load(WelcomeAndChooseStorage.class.getResource(this.html)
				.toExternalForm());
	}

	/**
	 * set delete animation
	 */
	private void setDeleteAnimation() {
		setMessage();

		JSONArray jsonFocus = constructFocusArray();

		setFocusAnimation(jsonFocus);
		win.call("addHideAnimation", jsonFocus);
		win.call("clearCommandLine");
		win.call("hideSuggestion");
	}

	/**
	 * set message in display
	 */
	private void setMessage() {
		if (this.display.getMessage() != null)
			win.call("showFeedBack", this.display.getMessage());
	}

	/**
	 * construct JSONArray from list of integers
	 * 
	 * @return
	 */
	private JSONArray constructFocusArray() {
		JSONArray jsonFocus = new JSONArray();
		for (int i = 0; i < this.display.getTaskIndices().size(); i++) {
			jsonFocus.put(this.display.getTaskIndices().get(i));
		}
		return jsonFocus;
	}

	public Display getDisplay() {
		return this.display;
	}

	// JavaScript interface object
	public class ListBridge {
		/**
		 * receive use cmd, add cmd history and decide what to do
		 * 
		 * @param command
		 */
		public void receiveCommand(String command) {
			String cmd = command.trim();

			setCmdHistory(cmd);

			if (cmd.toLowerCase().equals("help")
					|| cmd.toLowerCase().equals("show help")) {
				GUIController.displayHelp();
			} else if (cmd.toLowerCase().equals("change filepath")) {
				changeStorageLocation();
			} else if (cmd.toLowerCase().equals("exit")
					|| cmd.toLowerCase().equals("quit")) {
				App.terminate();
			} else {
				GUIController.handelUserInput(cmd);
			}
		}

		/**
		 * set cmd history
		 * 
		 * @param cmd
		 */
		private void setCmdHistory(String cmd) {
			userCmd.add(cmd);
			cmdIndex = userCmd.size() - 1;
		}

		/**
		 * pop up a file chooser and send new filepath
		 */
		private void changeStorageLocation() {
			DirectoryChooser fileChooser = new DirectoryChooser();
			File selectedFile = fileChooser.showDialog(App.stage);
			fileChooser.setTitle("Please select a folder for storage location");

			if (selectedFile != null) {
				App.filePath = selectedFile.getAbsolutePath()
						+ "\\J.Listee.txt";
				// create file under the file folder chosen by user
				GUIController.changeFilePath(App.filePath);
			}
		}

		public String getCommandsuggestion(String cmd) {
			String cmdSuggestion = suggestion.getSuggestedInput(cmd.trim());
			if (cmdSuggestion.equals(new String("null")) == false) {
				return cmdSuggestion;
			} else {
				return "";
			}
		}

		public String getPreviousCmd() {
			if (cmdIndex > 0) {
				return userCmd.get(cmdIndex--);
			} else {
				return userCmd.get(0);
			}
		}

		public String getLaterCmd() {
			if (cmdIndex < userCmd.size() - 1) {
				return userCmd.get(++cmdIndex);
			} else
				return "";
		}
	}
}
```
###### CS2103\src\gui\WelcomeAndChooseStorage.java
``` java
 */
public class WelcomeAndChooseStorage extends AppPage {

	public WelcomeAndChooseStorage() {
		super("/view/html/launch.html");
		JSObject win = (JSObject) webEngine.executeScript("window");
		win.setMember("app", new WelcomeBridge());
	}

	// JavaScript interface object
	public class WelcomeBridge {

		public void chooseFolder() {
			DirectoryChooser fileChooser = new DirectoryChooser();
			File selectedFile = fileChooser.showDialog(App.stage);
			fileChooser.setTitle("Please select a folder for storage location");

			if (selectedFile != null) {
				App.filePath = selectedFile.getAbsolutePath()
						+ "\\J.Listee.txt";
				// create file under the file folder chosen by user
				try {
					GUIController.createFile(App.filePath);
					// display starting page
					GUIController.initializeList(App.filePath);
				} catch (IOException e) {
					JOptionPane.showMessageDialog(null, e.getMessage());
				}
			}
		}
	}

}
```
###### CS2103\src\main\App.java
``` java
 */
public class App extends Application{
	//shortcut to quick launch
	private static final String SHORTCUT_LAUNCH="control alt SPACE";
	
	//the tray icon path
	private static final String ICON_TRAY="/view/images/tray-icon.png";
	private static final String ICON_DESKTOP="/view/images/desktop-icon.png";
	
	// This the scene stage of application
	public static Stage stage;
	
	// this is the task file
	public static String filePath;
	
	// this is the coordinates of the window
	public static double xOffset;
	public static double yOffset;
	
	//shortcut provider
	private static Provider shortcut=Provider.getCurrentProvider(false);
	
	//global hotey listener
	private HotKeyListener listener=null;
	
	//the tray icon of this app
	private static TrayIcon trayIcon;
	
	public static void main(String[] args) {
		Application.launch(args);
	}

	@Override
	public void start(Stage primaryStage) {
		Platform.setImplicitExit( false );

		setHotKeyListener();
		
		//register global hotkey
        shortcut.register(KeyStroke.getKeyStroke(SHORTCUT_LAUNCH), listener);
        
		stage = primaryStage;

		enableTray();
		
		stage.getIcons().add(new Image(this.getClass().getResourceAsStream(ICON_DESKTOP)));
		stage.initStyle(StageStyle.UNDECORATED);
		stage.initStyle(StageStyle.TRANSPARENT);
		stage.setTitle("J.Listee");
		stage.setResizable(false);
		GUIController.setStage(stage);
		judgeAndShowStart();
	}

	/**
	 * set hot key listener
	 */
	private void setHotKeyListener() {
		listener=new HotKeyListener() {			
			@Override
			public void onHotKey(HotKey hotkey) {
				if (stage.isShowing()) {
					Platform.runLater(new Runnable() {
						@Override
						public void run() {
							stage.hide();
						}
					});
				} else {
					Platform.runLater(new Runnable() {
						@Override
						public void run() {
							stage.show();
						}
					});
				}
			}
		};
	}

	private void enableTray() {
		PopupMenu popupMenu = new PopupMenu();
		java.awt.MenuItem openItem = new java.awt.MenuItem("Show");
		java.awt.MenuItem hideItem = new java.awt.MenuItem("Minimize");
		java.awt.MenuItem quitItem = new java.awt.MenuItem("Exit");

		ActionListener actionListener = setTrayActionListener();

		// set listener for double click
		MouseListener mouseListener = setMouseListener();

		openItem.addActionListener(actionListener);
		quitItem.addActionListener(actionListener);
		hideItem.addActionListener(actionListener);
 
		popupMenu.add(openItem);
		popupMenu.add(hideItem);
		popupMenu.add(quitItem);
 
		try {
			SystemTray tray = SystemTray.getSystemTray();
			BufferedImage image = ImageIO.read(this.getClass()
					.getResourceAsStream(ICON_TRAY));
			trayIcon = new TrayIcon(image, "J.Listee", popupMenu);
			trayIcon.setToolTip("J.Listee");
			tray.add(trayIcon);
			trayIcon.addMouseListener(mouseListener);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	/**
	 * @return
	 */
	private ActionListener setTrayActionListener() {
		ActionListener actionListener = new ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent e) {
				java.awt.MenuItem item = (java.awt.MenuItem) e.getSource();

				if (item.getLabel().equals("Exit")) {				
					terminate();
					return;
				}
				if (item.getLabel().equals("Show")) {
					Platform.runLater(new Runnable() {						
						@Override
						public void run() {
							stage.show();
						}
					});
					return;
				}
				if (item.getLabel().equals("Minimize")) {
					Platform.runLater(new Runnable() {
						@Override
						public void run() {
							stage.hide();
						}
					});
					return;
				}
			}
		};
		return actionListener;
	}

	/**
	 * @return
	 */
	private MouseListener setMouseListener() {
		MouseListener mouseListener = new MouseListener() {
			public void mouseReleased(MouseEvent e) {}
			public void mousePressed(MouseEvent e) {}
			public void mouseExited(MouseEvent e) {}
			public void mouseEntered(MouseEvent e) {}

			public void mouseClicked(MouseEvent e) {
				if (e.getClickCount() == 2) {
					if (stage.isShowing()) {
						Platform.runLater(new Runnable() {
							@Override
							public void run() {
								stage.hide();
							}
						});
					} else {
						Platform.runLater(new Runnable() {
							@Override
							public void run() {
								stage.show();
							}
						});
					}
				}
			}
		};
		return mouseListener;
	}

	/**
	 * judge if it's the first time user use this app and show start page
	 */
	private void judgeAndShowStart() {
		// read log file
		try {
			filePath = LogStorage.readLog();
		} catch (IOException e) {
			JOptionPane.showMessageDialog(null, e.getMessage());
		}

		// check if it's the first time that user use the application
		if (filePath == null) {
			GUIController.displayWelcome();
		} else {
			GUIController.initializeList(filePath);
		}
	}

	public static void terminate(){
		SystemTray.getSystemTray().remove(trayIcon);
		shortcut.reset();
		shortcut.stop();
		Platform.exit();
	}

}
```
###### CS2103\src\storage\LogStorage.java
``` java
 */
public class LogStorage {
	  //this is the log file path, storing the location of the task file
		public static String logFile=System.getProperty("user.home") + File.separator + "J.Listee.log";
		
		
	/**
	 * Read the log file, and find the file of task list. 
	 * check if log file exists, if not exists, it's the very first time that user use J.Listee
	 * 
	 * @return null if there's no file path in the log file or log file doesn't exist, else return file path
	 * @throws IOException
	 *             If an I/O error occurs during readLine()
	 */
	public static String readLog() throws IOException {
		File file = new File(logFile);
			if (!file.exists()) {
				try {
					file.createNewFile();
				} catch (IOException e) {
					throw new IOException("Error: Cannot create log file");
				}
				return null;
			}else{
				return readLogFile();
			}
	}

	/**
	 * Write in the log file the filepath
	 * @throws IOException
	 *             If an I/O error occurs during operations of bw and fos
	 */
	public static void writeLogFile(String filePath) throws IOException {
		FileOutputStream fos;
		try {
			fos = new FileOutputStream(logFile);
			BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(fos));

			bw.write(filePath);
			bw.flush();
			fos.close();
			bw.close();
		} catch ( FileNotFoundException e) {
			throw new FileNotFoundException("Log file not found!");
		} catch (IOException e) {
			throw new IOException("Cannot write to log file!");
		}
		
	}
	
	/**
	 * read from the log file to find the filePath
	 * 
	 * @return the file path in the log file, null if it doesn't exist
	 * @throws IOException
	 */
	private static String readLogFile() throws IOException{
		String filePath=null;
		BufferedReader br;
		try {
			br = new BufferedReader(new InputStreamReader(new FileInputStream(
					logFile)));
		String lineStr;
			lineStr = br.readLine();
			if(lineStr!=null){
				filePath=lineStr;
			}
			br.close();
		} catch (FileNotFoundException e) {
			throw new FileNotFoundException("Log file not found!");
		}catch (IOException e) {
			throw new IOException("Cannot read from log file!");
		}		
		return filePath;
	}
}
```
###### CS2103\src\tests\LogStorageTest.java
``` java
 */
public class LogStorageTest {
	File logFile=new File(LogStorage.logFile);
	String filePath="This is a file Path";
	
	@Before
	public void setUp() throws Exception {		
		if(logFile.exists()){
			System.out.println("exist");
			System.out.println(logFile.delete());
		}
	}

	//Test read log file
	//This is the test case  for the 'nonexistent log file' partition
	@Test
	public void testReadNonExistentLog() throws IOException {
		assertEquals(null, LogStorage.readLog());
	}
	
	//This is the test case for 'read empty log file' partition
	@Test 
	public void testReadEmptyLog() throws IOException{
		assertEquals(null, LogStorage.readLog());
	}
	
	//This the test case for 'read valid log file' partition
	@Test
	public void testReadValidLog() throws IOException{
		FileOutputStream fos = new FileOutputStream(LogStorage.logFile);
		BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(fos));	
		bw.write(filePath);
		bw.flush();
		fos.close();
		bw.close();
		assertEquals(filePath, LogStorage.readLog());
	}
	
	//Test writeLogFile()
	//This is the test case for 'write directory file' partition
	@Test
	public void testWriteNonexistentFile() {
		LogStorage.logFile="D:\\";
		try {
			LogStorage.writeLogFile("");
			fail( "My method didn't throw IOException" );
		} catch (IOException e) {
		}
	}
	
	//This the test case for 'valid wrting' partition
	@Test
	public void testValidWriting() throws IOException{
		LogStorage.logFile="D:\\J.Listee.log";
		LogStorage.writeLogFile(filePath);
		assertEquals(filePath, LogStorage.readLog());
	}

}
```
###### CS2103\src\view\html\help.html
``` html
 body{
 	background: rgba(0,0,0,0);
 }
 #wrapper{
 	margin:0 auto;
 }
 .center {
 	width: 700px;
 }
 .tut{
 	height:653px;
 	padding: 15px;
 	padding-right: 5px;
 	background-color:rgba(238,238,238,1.0);
 	overflow-y: scroll;
 }
 .commandline{
 	background-color: #726e6e;
 	height: 55px;
 }
 .panel-heading{
 	background-color: #3273b1;
 	color: #fff;
 }
 h1{
 	color: #3273b1;
 	font-weight: 600;
 }
 form{
 	width: 100%;
 	height: 100%;
 }
 input{
 	width: 100%;
 	height: 100%;
 	background: transparent;
 	color: #fff;
 	border: 0;
 	outline:none;
 	line-height: 30px;
 	font-size: 20px;
 	padding: 15px;
 }
 .page-header,.panel-heading{
 	text-align: center;
 }
 #suggestion-bar{
    width: 700px;
    display: none;
  }
  .arrow-up {
    width: 0;
    height: 0;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-bottom: 7px solid #333;
    position: relative;
    left: 30px;
  }
  .command_suggestion{
    height: 35px;
    background-color: #333;
    width: 100%;
    border-radius: 10px;
    color: #ddd;
    font-size: 18px;
    padding: 5px 15px;
  }
</style>
</head>
<body scroll="no">
	<script>

		function shortCutCommand(cmd){
			app.receiveCommand(cmd);
		}

		function sendCommand() {
			var command = cmd.elements['command'].value;
		  // Invoke the 'receive' Java callback
		  app.receiveCommand(command);
		}

		function clearCommandLine(){
			$(command).val("");
		}

//Prevent the backspace key from navigating back.
$(document).unbind('keydown').bind('keydown', function (event) {
	var doPrevent = false;
	if (event.keyCode === 8) {
		var d = event.srcElement || event.target;
		if ((d.tagName.toUpperCase() === 'INPUT' && 
			(
				d.type.toUpperCase() === 'TEXT' ||
				d.type.toUpperCase() === 'PASSWORD' || 
				d.type.toUpperCase() === 'FILE' || 
				d.type.toUpperCase() === 'SEARCH' || 
				d.type.toUpperCase() === 'EMAIL' || 
				d.type.toUpperCase() === 'NUMBER' || 
				d.type.toUpperCase() === 'DATE' )
			) || 
			d.tagName.toUpperCase() === 'TEXTAREA') {
			doPrevent = d.readOnly || d.disabled;
	}
	else {
		doPrevent = true;
	}
}
if (doPrevent) {
	event.preventDefault();
}
});

$(document).keydown(
	function(e)
	{   
		switch(e.keyCode){
        case 32://space bar
        var d = e.srcElement || e.target;
        if (d.tagName.toUpperCase() != 'INPUT'){
        	$(command).focus();
        	$(command).val("");
        }
        break;
}
		});

function getCommandsuggestion()
{
	if(cmd.elements['command'].value==''){
		$("#suggestion-bar").hide();
	}

  //send command when typing
  if(app.getCommandsuggestion(cmd.elements['command'].value)!=''){
  	$("#suggestion-bar").show();
  	$("#suggstion").text(app.getCommandsuggestion(cmd.elements['command'].value));
  }else{
  	$("#suggestion-bar").hide();
  }
  
};
</script>
<div id="wrapper">
	<div class="center">
		<div class="main">
			<div class="tut">
				<div class="page-header">
					<h1>J.Listee <small>Your Personal To-Do Manager</small></h1>
				</div>
				<div class="panel panel-default">
					<!-- Default panel contents -->
					<div class="panel-heading" style="background-color: #3273b1; color: #fff;font-size:20px;">Features and Commands</div>
					<div class="panel-body">
						<p>J.Listee is a GTD desktop application which can help you to manage your to-do list. </p>
						<p><strong>Features include:</strong>
							<br>&diams;&nbsp;   create a task with or without date and time
							<br>&diams;&nbsp;   edit an existing task
							<br>&diams;&nbsp;    delete existing tasks
							<br>&diams;&nbsp; 	search tasks by keywords or by group
							<br>&diams;&nbsp; 	postpone a task
							<br>&diams;&nbsp; 	reserve time slots for a task
							<br>&diams;&nbsp; 	confirm a time slot for a reserved task
							<br>&diams;&nbsp; 	mark a task as done/undone
							<br>&diams;&nbsp; 	undo/redo previous commands
							<br>&diams;&nbsp; 	change storage location
						</p>
					</div>

					<!-- Table -->
					<table class="table">
						<thead>
							<tr>
								<th>#</th>
								<th>Command format</th>
								<th>Example</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th scope="row">1</th>
								<td>&lt;add> [description] [&lt;preposition> time] [@location] [#tags<br>(for deadline)</td>
								<td>add good friday this friday @home #yay #study</td>
							</tr>
							<tr>
								<th scope="row">2</th>
								<td>&lt;add> [description] [&lt;from> start time &lt;to> end time] [*@*location] [#tag]<br>(for event)</td>
								<td>add meeting with prof @com1 #work from 1st april 2pm to 5th april 3pm</td>
							</tr>
							<tr>
								<th scope="row">3</th>
								<td>&lt;add> [description] [@location] [#tags]<br>(for untimed)</td>
								<td> add @room clean</td>
							</tr>
							<tr>
								<th scope="row">4</th>
								<td>&lt;del> or &lt;delete> &lt;starting task number - ending task number><br>&lt;del> or &lt;delete> &lt;tasknumber, tasknumber, tasknumber></td>
								<td>delete 1-3, 5 <br> delete 1,2,3,4,5 <br>delete 1-5</td>
							</tr>
							<tr>
								<th scope="row">5</th>
								<td>&lt;update> &lt;task number > [&lt;/timegroup> time] [task description] [@location] OR [-@] [#hashtags][-#deletehashtags]<br>(not for reserved)</td>
								<td>update 2 more work /end tonight 2359<br>edit 2 /both today from 3pm to 6pm -@</td>
							</tr>
							<tr>
								<th scope="row">6</th>
								<td>&lt;update> &lt;task number > [&lt;reservation index> &lt;[-]/timegroup [time]> [task description] [@location] OR [-@] [#hashtags][-#deletehashtags]<br>(for reserved)</td>
								<td>update 1 1 / start today 4pm<br>edit 2 meeting manager @ofï¬?ce<br>edit 3 -start</td>
							</tr>
							<tr>
								<th scope="row">7</th>
								<td>&lt;show> [task description] [/taskgroup][&lt;preposition> time] [@location] [#hashtags]</td>
								<td>show assignment due friday</td>
							</tr>
							<tr>
								<th scope="row">8</th>
								<td>&lt;undone> or &lt;done> &lt;starting task number - ending task number><br>&lt;undone> or &lt;done> tasknumber, tasknumber, tasknumber></td>
								<td>done 1-3, 5 <br>undone 1,2,3,4,5 <br>undone 1-5</td>
							</tr>
							<tr>
								<th scope="row">9</th>
								<td>&lt;postpone> &lt;task number> &lt;time></td>
								<td> postpone 2 2hours 4mins<br>postpone 3 3years</td>
							</tr>
							<tr>
								<th scope="row">10</th>
								<td>reserve &lt;task description> [&lt;from> start time &lt;to> end time] [and/or] [&lt;from> start time &lt;to> end time] [@location] [#hashtags]</td>
								<td>reserve meet friends from thursday 4pm to thursday 6pm or friday 4pm to 6pm #dinner</td>
							</tr>
							<tr>
								<th scope="row">11</th>
								<td>conï¬?rm &lt;conï¬?rm> &lt;tasknumber> &lt;reserve task index></td>
								<td>confirm 2, 3</td>
							</tr>
							<tr>
								<th scope="row">12</th>
								<td>undo or redo</td>
								<td>undo<br>redo</td>
							</tr>
							<tr>
								<th scope="row">13</th>
								<td>change filepath</td>
								<td>change filepath</td>
							</tr>
							<tr>
								<th scope="row">14</th>
								<td>help</td>
								<td>help</td>
							</tr>
							<tr>
								<th scope="row">15</th>
								<td>exit</td>
								<td>exit</td>
							</tr>
						</tbody>
					</table>
					<div class="panel-body">
					</div>
					<table class="table">
						<thead>
							<tr>
								<th>Task group for show/search</th>
								<th>Prepositions before time</th>
								<th>Time group for update</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>/today</td>
								<td> fromâ€¦toâ€¦ </td>
								<td>/end</td>
							</tr>
							<tr>
								<td>/tomorrow</td>
								<td> by </td>
								<td>/start</td>
							</tr>
							<tr>
								<td>/overdue</td>
								<td> on </td>
								<td>/etime</td>
							</tr>
							<tr>
								<td>/done</td>
								<td> at </td>
								<td>/stime</td>
							</tr>
							<tr>
								<td>/reserved</td>
								<td> due </td>
								<td>-alltime</td>
							</tr>
							<tr>
								<td>/events</td>
								<td> during </td>
								<td>-end</td>
							</tr>
							<tr>
								<td>/deadlines</td>
								<td> in </td>
								<td>-start</td>
							</tr>
							<tr>
								<td>/untimed</td>
								<td> for </td>
								<td>/both</td>
							</tr>
							<tr>
								<td></td>
								<td> this </td>
								<td></td>
							</tr>
							<tr>
								<td></td>
								<td> before </td>
								<td></td>
							</tr>
							<tr>
								<td></td>
								<td> after </td>
								<td></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>		
		</div>
		<div class="commandline">
			<form name="cmd">
				<input type="text" name="command" id="command" onkeyup="getCommandsuggestion();" onkeydown="if(event.keyCode==13){sendCommand();}" placeholder="Type 'back' here" autofocus/>
			</form>
		</div>
	</div>
	<div id="suggestion-bar">
  <div class="arrow-up"></div>
  <div class="command_suggestion" id="suggstion"></div>
</div>
</div>
</body>
</html>
```
###### CS2103\src\view\html\launch.html
``` html
  body{
	    background: rgba(0,0,0,0);
	  }
   #wrapper{
     margin:0 auto;
     height: 600px;
   }
   .center {
     width: 700px;
     height: 100%;
     text-align: center;
   }
   .btn-lg{
    width: 80%;
    font-size: 25px;
   }
   h1{
    font-size: 60px;
   }
   .jumbotron{
    width: 100%;
    height:100%;
    padding: 50px;
    margin-bottom: 0px;
   }
 </style>
</head>
<body>
	<script>
    function chooseFolder() {
   // Call Java callback function and pass text fields values.
   app.chooseFolder();
 }
</script>
	<div id="wrapper">
		<div class="center">
			<div class="jumbotron">
				<br> <br>
				<h1>Welcome to J.Listee!</h1>
				<p>
					<br>
					<br>Now please specify a folder as the data storage location.
					You can use a cloud syncing service to control your to-do list.
				</p>
				<br> <br> <br>
				<p>
					<a class="btn btn-primary btn-lg" href="#" role="button"
						onclick="chooseFolder();">Choose a folder</a>
				</p>
				<br>
			</div>
		</div>
	</div>
</body>
</html>
```
###### CS2103\src\view\html\list.html
``` html
  body{
    background: rgba(0,0,0,0);
  }
   .center {
     width: 700px;
     text-align: center;
   }
   .list{ 
    height:653px;
    padding: 8px 15px;
    padding-right: 5px;
    background-color:rgba(238,238,238,1.0);
    overflow-y:scroll;
  }

  .commandline{
    background-color: #726e6e;
    height: 55px;
  }
  .grouptitle{
    font-size: 23px;
    color: #888;
    font-weight: 100;
  }
  .title{
    font-size: 25px;
    color: #555;
    font-weight: 100;
  }
  section{
    display: inline-block;
  }
  .task{
    width: 100%;
    height:58px;
    border-radius: 8px;
    background-color: rgba(255,255,255,0.7);
    margin: 1px 0 6px 0;
    vertical-align: middle;
  }
  .task:focus{
    background-color: rgba(255,255,255,1.0);
    outline: 0;
    border-radius: 8px;
    box-shadow: 0 0 0 1.5px #ccc;
  }
  .overdue:focus{
    background-color: rgba(235,131,99,0.3);
  }
  .conflict{
    outline: 0;
    border-radius: 8px;
    box-shadow: 0 0 0 1.5px #ccc;
  }
  .task_number{
    width:8%;
    height: 100%;
    border-radius: 8px 0 0 8px;
    background-color: rgba(131,207,203,0.8);
    font-size: 35px;
    line-height: 58px;
    color: #444;
    float: left;
  }
  .overdue .task_number{
    background-color: rgba(235,131,99,0.8);
  }
  .overdue {
    background-color: rgba(235,131,99,0.25);
  }
  .task_middle{
    display:table;
    float: left;
    width:69.5%;
    height: 100%;
    text-align: left;
    padding:4px 0px 3px 10px;
  }
  .task_right{
    float: right;
    height: 100%;
    display: table;
    width: 22.5%;
    padding: 5px 8px 5px 5px;
    text-align: right;
  }

  .task_description{
    font-size: 18px;
  }
  .time{
    font-size: 14px;
  }
  .time>div{
    vertical-align: middle;
    display: table-cell;
    padding: 0 4px;
  }
  .time span{
    padding: 0px 8px;
    display: block;
    border-radius: 3px;
  }
  .task_components,.task_location,.task_tags{
    margin: 4px 5px 4px 0px;
  }
  .task_middle .task_components{
    display:table-row;
    height: 50%;
  }
  #description{
    display: table-cell;
    vertical-align: middle;
  }
  .task_middle section,.task_middle span{
    line-height: 14px;
    height:20px;
    border-radius: 3px;
    padding: 2px;
    text-align: center;
  }
  .task_location{    
    background-color: rgba(63,190,122,0.4);    
  }
  .task_tags span{
    background-color: #d8d8d8;
    margin-right: 5px;
  }
  .task_right>div{
    display: table-row;
  }
  .task_lowertime span{
    background-color: rgba(240,108,125,0.4);
  }
  .task_uppertime span{
    background-color: rgba(0,181,242,0.4);
  }
  .overdue span{
    background-color: rgba(255,255,255,0.5);
  }
  #tasklist_deadline .time{
    position: relative;
    top: 23%;
  }
  form{
    width: 100%;
    height: 100%;
  }
  input{
    width: 100%;
    height: 100%;
    background: transparent;
    color: #fff;
    border: 0;
    outline:none;
    line-height: 30px;
    font-size: 20px;
    padding: 15px;
  }
  .alert{
    position:absolute;
    display:none;
    bottom: 97px;
    margin-bottom: 0;
    width: 700px;
    height: 40px;
    padding: 10px;
  }
  .reserved .reserve_list{
    padding: 0;
    width: 100%;
    height: 100%;
    margin: 0 auto;
  }
  .timeslot{
    width: 33%;
    padding-right: 6px;
    float: right;
    height: 58px;
    background-color: #dfdfdf;
    margin-left: 1px;
  }
  .reserved .task_middle{
    width:35%;
  }
  .reserved .task_right{
    padding: 0;
    width: 57%;
  }
  #timeslot1{
    border-radius: 0 8px 8px 0;
  }
  #suggestion-bar{
    width: 700px;
    display: none;
  }
  .arrow-up {
    width: 0;
    height: 0;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-bottom: 7px solid #333;
    position: relative;
    left: 30px;
  }
  .command_suggestion{
    height: 35px;
    background-color: #333;
    width: 100%;
    border-radius: 10px;
    color: #ddd;
    font-size: 18px;
    padding: 5px 15px;
  }
 .index{
 	width: 12px;
    font-size: 12px;
    text-align: center;
    float: left;
    color: white;
    border-radius: 3.5px;
    background-color: rgba(114, 110, 110,0.4);
 }
</style>
</head>
<body>
  <script  type="text/javascript">
    var i=0;

    function reset(){
      i=0;
    }

    function reload() {
      window.location.reload();
    }
    
    function addReservedTask(jsonTasks){
      var taskList = JSON.parse(jsonTasks);

      if(taskList.length==0)
        return;

      var tasklist_=document.getElementById("tasklist_reserved");
      $(reserved_title).text("Reserved");
      
      //remove all existing children
      while (tasklist_.firstChild) {
        tasklist_.removeChild(tasklist_.firstChild);
      }

      for  (index = 0; index < taskList.length; index++){

        var taskdiv = document.createElement("div");
        taskdiv.setAttribute("class", "task");
        taskdiv.setAttribute("tabindex", "0");
        taskdiv.setAttribute("id", i+1);

        var detail="Description: "+taskList[index].description;
        taskdiv.setAttribute("data-toggle","tooltip");
        taskdiv.setAttribute("data-placement","auto");

        //restric displaying discription length
        var description="";
        if(taskList[index].description.length<24){
          description=taskList[index].description;
        }else{
          description=taskList[index].description.substring(0,23)+"...";
        }

        taskdiv.innerHTML= "<section class='task_number'>"
        + (i+1)
        + "</section>"
        + "<section class='task_middle' id='task_middle'>"
        + "<div class='task_components task_description' id='task_description"
        + i
        + "'>"
        + "<div id='description'>"
        + description
        +"</div>"
        + "</div>"
        + "<div class='task_components' id='task_details"
        + i
        +"'>"
        + "<section class='task_location' id='task_location"
        + i
        +"'>"

        + "</section>"
        + "<section class='task_tags' id='task_tags"
        + i
        +"'>"

        + "</section>"
        + "</div>"
        + "</section>"
        + "<section class='task_right'>"
        + "<div class='reserve_list' id='timeslot_list"
        + i
        +"'>"
        + "</div> "
        + "</section>"

        tasklist_.appendChild(taskdiv);

        var task_location=document.getElementById("task_location"+i);
        var task_tags=document.getElementById("task_tags"+i);
        var task_details=document.getElementById("task_details"+i);
        var timeslot_list=document.getElementById("timeslot_list"+i);

        if(taskList[index].location==undefined && taskList[index].tags.length==0){
          task_details.style.display="none";
        }else{
         //add location if necessary
         if(taskList[index].location!=undefined){
           var locationspan = document.createElement("span");
           locationspan.innerHTML="@"+taskList[index].location;
           task_location.appendChild(locationspan);

           detail=detail+"<br>Location: "+taskList[index].location;
         }
         else{
           task_location.style.display="none";
         }

         //add tags if necessary at most 3
         if(taskList[index].tags.length>0){

          detail=detail+"<br>"+"Tags: ";
          for  (index2 = 0; index2 < taskList[index].tags.length; index2++){
            detail=detail+"#"+taskList[index].tags[index2]+", ";
          }

          if(taskList[index].tags.length>3){
            taskList[index].tags[2]="...";
          }
          
          for  (index2 = 0; index2 < taskList[index].tags.length && index2 < 3; index2++){
           var tagspan = document.createElement("span");
           tagspan.innerHTML="#"+taskList[index].tags[index2];
           task_tags.appendChild(tagspan);
          }
         }
         else{
           task_tags.style.display="none";
         }
        }
        var len=taskList[index].startDates.length;
        detail=detail+"<br>Time slots: ";

        for( index3 =0; index3 < len; index3++){
          detail+="<br>("+taskList[index].startDates[index3]+", "+taskList[index].endDates[index3]+")";
        }

        taskdiv.setAttribute("title","<h5 style='text-align:left; overflow: hidden; overflow-wrap: break-word;'>"+detail+"</h5>");

        //add timeslots at most 3
        for( index3 =len-1; index3>=0 && len-index3<4; index3--){
           var timeslot = document.createElement("div");
           timeslot.setAttribute("class", "timeslot");
           timeslot.setAttribute("id", "timeslot"+(index3));
           timeslot.innerHTML="<div class='index'>"+(index3+1)+"</div>"+"<div style='margin: 8px 0 0;'>"+taskList[index].startDates[index3]+"</div><div>"+taskList[index].endDates[index3]+"<div>";
           timeslot_list.appendChild(timeslot);
        }

        i=i+1;
      }
     $("[data-toggle='tooltip']").tooltip({html : true }); 
    }

    function addTasks(jsonTasks, type){
      var taskList = JSON.parse(jsonTasks);
     
      if(taskList.length==0)
        return;

      if(type=="deadline"){
        var tasklist_=document.getElementById("tasklist_deadline");
        $(deadline_title).text("Deadlines");
      }else if(type=="event"){
        var tasklist_=document.getElementById("tasklist_event");
        $(event_title).text("Events");
      }else if(type=="floating"){
        var tasklist_=document.getElementById("tasklist_floating");
        $(float_title).text("Untimed");
      }else if(type=="completed"){
        var tasklist_=document.getElementById("tasklist_mixed");
        $(title).text("Completed Tasks");
      }

    //remove all existing children
    while (tasklist_.firstChild) {
      tasklist_.removeChild(tasklist_.firstChild);
    }

    for  (index = 0; index < taskList.length; index++){

      //restric displaying discription length
      var description="";
      if(taskList[index].description.length<50){
        description=taskList[index].description;
      }else{
        description=taskList[index].description.substring(0,49)+"...";
      }

      var taskdiv = document.createElement("div");
      if(taskList[index].overdue==true){
        taskdiv.setAttribute("class", "task overdue");
      }else{
        taskdiv.setAttribute("class", "task");
      }
      taskdiv.setAttribute("tabindex", "0");
      taskdiv.setAttribute("id", i+1);

      var detail="Description: "+taskList[index].description;
      taskdiv.setAttribute("data-toggle","tooltip");
      taskdiv.setAttribute("data-placement","auto");

      taskdiv.innerHTML= "<section class='task_number'>"
      + (i+1)
      +"</section>"
      + "<section class='task_middle' id='task_middle'>"
      + "<div class='task_components task_description' id='task_description"
      + i
      + "'>"
      + "<div id=description>"
      + description
      + "</div>"
      +"</div>"
      + "<div class='task_components' id='task_details"
      + i
      +"'>"
      + "<section class='task_location'id='task_location"
      + i
      +"'>"

      +"</section>"
      + "<section class='task_tags' id='task_tags"
      + i
      +"'>"
      + "</div>"
      + "</section>"
      + "</section>"
      + "<section class='task_right'>"
      + "<div class='task_components time task_uppertime' id='task_start_div"
      + i
      + "'>"
      + "<div>"
      + "<span id='task_start"
      + i
      + "'>"
      + "</span>"
      + "</div>"
      +"</div>"
      + " <div class='task_components time task_lowertime' id='task_end_div"
      + i
      + "'>"
        + "<div>"
      + "<span id='task_end"
      + i
      + "'>"
      + "</span>"
      + "</div>"
      +"</div>"
      + "</section>"

      tasklist_.appendChild(taskdiv);

      var task_location=document.getElementById("task_location"+i);
      var task_start=document.getElementById("task_start"+i);
      var task_end=document.getElementById("task_end"+i);
      var task_tags=document.getElementById("task_tags"+i);
      var task_details=document.getElementById("task_details"+i);

      if(taskList[index].location==undefined && taskList[index].tags.length==0){
        task_details.style.display="none";
      }else{
         //add location if necessary
         if(taskList[index].location!=undefined){
           var locationspan = document.createElement("span");
           locationspan.innerHTML="@"+taskList[index].location;
           task_location.appendChild(locationspan);

           detail=detail+"<br>Location: "+taskList[index].location;
         }
         else{
           task_location.style.display="none";
         }

         //add tags if necessary
         if(taskList[index].tags.length!=0){

          detail=detail+"<br>"+"Tags: ";
          for  (index2 = 0; index2 < taskList[index].tags.length; index2++){
            detail=detail+"#"+taskList[index].tags[index2]+", ";
          }

          if(taskList[index].tags.length>4){
            taskList[index].tags[3]="...";
          }          
          for  (index2 = 0; index2 < taskList[index].tags.length && index2 < 4; index2++){
           var tagspan = document.createElement("span");
           tagspan.innerHTML="#"+taskList[index].tags[index2];
           task_tags.appendChild(tagspan);        
         }
       }
       else{
         task_tags.style.display="none";
       }
     }


     //add startDate if necessary
     if(taskList[index].startDate!=undefined){        
       task_start.innerHTML=taskList[index].startDate;

       detail=detail+"<br>Start Date: "+taskList[index].startDate;
     }
     else{
       $("#task_start_div"+i).hide();
     }

     //add endDate if necessary
     if(taskList[index].endDate!=undefined){
       task_end.innerHTML= taskList[index].endDate;
       detail=detail+"<br>End Date: "+taskList[index].endDate;
     }
     else{
       $("#task_end_div"+i).hide();
     }

     taskdiv.setAttribute("title","<h5 style='text-align:left; overflow: hidden; overflow-wrap: break-word;'>"+detail+"</h5>");

     i=i+1;
   }    
   $("[data-toggle='tooltip']").tooltip({html : true }); 
 }

 function sendCommand() {
  var command = cmd.elements['command'].value;
  // Invoke the 'receive' Java callback
  app.receiveCommand(command);
  }

function shortCutCommand(cmd){
  app.receiveCommand(cmd);
}

function showFeedBack(feedback){
  $("#feedback").text(feedback);
  $("#feedback").slideToggle("slow");
  setTimeout("hideFeedBack()",2500);
}

function hideFeedBack(){
  $("#feedback").slideToggle();
}

function setFocus(indices){
  var indexList = JSON.parse(indices);

  for(var i=0;i<indexList.length;i++){
    $("#"+indexList[i]).focus();
  }
}

function showConflict(conflics){
  setTimeout(
    function (){
  var indexList = JSON.parse(conflics);

  for(var i=0;i<indexList.length;i++){
    $("#"+indexList[i]).fadeOut(200).fadeIn(200).fadeOut(200).fadeIn(200);
  }
},1000);
}

function addShowAnimation(indices){
  var indexList = JSON.parse(indices);

  for(var i=0;i<indexList.length;i++){
    $("#"+indexList[i]).hide();
  }

  for(var i=0;i<indexList.length;i++){
    $("#"+indexList[i]).toggle(900);
  }
}

function addHideAnimation(indices){
  var indexList = JSON.parse(indices);

  for(var i=0;i<indexList.length;i++){
    var j=parseInt(indexList[i])-i;
    $("#"+j).toggle(900);

    $("#"+j).attr("id",0);
    var index=j+1;
    //update indices of flollowing tasks
    while($("#"+index).length){
      $("#"+index).children("section.task_number").text(index-1);
      $("#"+index).attr("id",index-1);

      index=index+1;
    }
  }
}

function clearCommandLine(){
  $(command).val("");
}

//Prevent the backspace key from navigating back.
$(document).unbind('keydown').bind('keydown', function (event) {
    var doPrevent = false;
    if (event.keyCode === 8) {
        var d = event.srcElement || event.target;
        if ((d.tagName.toUpperCase() === 'INPUT' && 
             (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'NUMBER' || 
                 d.type.toUpperCase() === 'DATE' )
             ) || 
             d.tagName.toUpperCase() === 'TEXTAREA') {
            doPrevent = d.readOnly || d.disabled;
        }
        else {
            doPrevent = true;
        }
    }
    if (doPrevent) {
        event.preventDefault();
    }
});


function getCommandsuggestion()
{
  if(cmd.elements['command'].value==''){
    $("#suggestion-bar").hide();
  }

  //send command when typing
  if(app.getCommandsuggestion(cmd.elements['command'].value)!=''){
    $("#suggestion-bar").show();
    $("#suggstion").text(app.getCommandsuggestion(cmd.elements['command'].value));
  }else{
    $("#suggestion-bar").hide();
  }
  
};

function hideSuggestion(){
  $("#suggestion-bar").hide();
}

$(document).keydown(
    function(e)
    {   
      switch(e.keyCode){
        case 32://space bar
          var d = e.srcElement || e.target;
           if (d.tagName.toUpperCase() != 'INPUT'){
            $(command).focus();
            $(command).val("");
          }
        break;
        case 40://key down
          var d = e.srcElement || e.target;
           if (d.tagName.toUpperCase() == 'INPUT')
           {
            $("#command").val(app.getLaterCmd());
           }else{
              if($(".task:focus").length==0){
                $(".task:last").focus();
              }else{
                var id=parseInt($(".task:focus")[0].id)+1;
                if(id==$(".task").length+1)
                  id=1;
                $("#"+id).focus();
              }   
           }
        break;
        case 38://key up
           var d = e.srcElement || e.target;
           if (d.tagName.toUpperCase() == 'INPUT')
           {
              $("#command").val(app.getPreviousCmd());
           }else{
              if($(".task:focus").length==0){
                $(".task:first").focus();
              }else{ 
                var id=parseInt($(".task:focus")[0].id)-1;
                if(id==0)
                  id=$(".task").length;
                $("#"+id).focus();
              }
           }
        break;
        case 46://delete
        case 8://backspace
          if($(".task:focus").length>0){
            var id=parseInt($(".task:focus")[0].id);
            console.log("delete "+id);
            shortCutCommand("delete "+id);
          }
        break;
        case 88://x
          if($(".task:focus").length>0){
            var id=parseInt($(".task:focus")[0].id);
            if($(title).text()=="Completed Tasks"){
              shortCutCommand("undone "+id);
            }else{
              shortCutCommand("done "+id);
            }            
          }
          break;
        case 80://p
          if($(".task:focus").length>0){
            var id=parseInt($(".task:focus")[0].id);
            shortCutCommand("postpone "+id);
          }
        break;
        case 90://ctrl+z
        	if(e.ctrlKey)
        		shortCutCommand("undo");
        break;
        case 89://ctrl+y
        	if(e.ctrlKey)
        		shortCutCommand("redo");
      }
    }
);

    $(function () { 
      $("[data-toggle='tooltip']").tooltip({html : true }); 
    });
</script>

<div id="wrapper">
 <div class="center">
  <div class="main">
    <div class="alert alert-success" id="feedback" role="alert"></div>
    
    <div class="list">
      <div class="title" id="title"></div>
      <div class="group deadline">
        <div class="grouptitle" id="deadline_title"></div>
        <div class="tasklist" id="tasklist_deadline">

        </div>
      </div>

      <div class="group event">
        <div class="grouptitle" id="event_title"></div>
        <div class="tasklist" id="tasklist_event">

        </div>
      </div>

      <div class="group floating">    
       <div class="grouptitle" id="float_title"></div> 
       <div class="tasklist" id="tasklist_floating">

       </div>
     </div>
     <div class="group reserved">    
       <div class="grouptitle" id="reserved_title"></div> 
       <div class="tasklist" id="tasklist_reserved">
          </div>
     </div>
    <div class="group mixed">
        <div class="grouptitle" id="mixed_title"></div>
        <div class="tasklist" id="tasklist_mixed">

        </div>
      </div>
   </div>
   <div class="commandline">
    <form name="cmd">
      <input type="text" name="command" id="command" onkeydown="if(event.keyCode==13){sendCommand();}" onkeyup="getCommandsuggestion();" placeholder="Type your command here" autofocus/>
    </form>
  </div>
</div>
</div>
<div id="suggestion-bar">
  <div class="arrow-up"></div>
  <div class="command_suggestion" id="suggstion"></div>
</div>

</div>
</body>
</html>
```
